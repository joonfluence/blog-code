# SSL의 동작방법

SSL은 암호화 방식으로 두 가지 방식(공개키 방식, 대칭키 방식)을 혼합해서 사용한다. 

- *클라이언트와 서버가 주고 받는 실제 정보*는 **대칭키 방식**으로 암호화 
- *대칭키 방식으로 암호화된 실제 정보를 복호화할 때 사용할 대칭키*는 **공개키 방식**으로 암호화

### 공개키 암호화 방식 (비대칭키 암호화 방식)

어떠한 정보를 암호화하거나 복호화할 때 사용하는 키가 서로 다른 경우를 의미합니다. 또 아래 두 가지 경우로 나뉠 수 있다. 

- 공개키로 정보를 암호화하는 경우 
- 개인키로 정보를 암호화하는 경우 

공개 키 암호 방식은 열쇠로 잠겨 있고 좁은 투입구가 있는 편지함에 비유할 수 있다. 이런 편지함은 위치(공개 키)만 알면 투입구를 통해 누구나 편지를 넣을 수 있지만 열쇠(개인 키)를 가진 사람만이 편지함을 열어 내용을 확인할 수 있다. 

- 장점

공개된 키가 유실되더라도 복호화할 수 없다는 장점이 있다. 
클라이언트는 서버에게 자신의 공개키를 전송하고, 서버는 클라이언트에게 자신의 공개키를 전송한다. 
서버는 데이터를 받아서, 자신이 받은 공개키로 복호화하면 될 수 있다. 비밀키의 소유자가 아니라면 복호화(decryption)할 수 없다. 
비밀번호가 노출되지 않는다는 장점이 있다. 

- 단점

공개키 방식은 암호화하고 복호화하는 과정에서 컴퓨팅 자원을 많이 사용한다. 

### 대칭키 암호화 방식

이름에서 알 수 있듯, 어떤 정보를 암호화하거나 복호화할 때 사용하는 키가 동일한 경우를 말합니다. 암호화된 정보를 전달하고 확인하기 위해서 송/수신자가 둘 다 같은 키를 가지고 있어야 하기 때문에, 이러한 키를 안전하게 교환하는 것이 대칭키 암호화 방식의 가장 중요한 부분 중 하나입니다. 

- 장점 

공개키 방식보다 컴퓨팅 자원을 덜 사용한다. 

# 악수 (handshake)

사람이 인사를 통해서 상대의 기분과 상황을 탐색하는 것처럼, 클라이언트와 서버도 실제 데이터를 주고 받기 전에 클라이언트와 서버는 일종의 인사인 Handshake를 한다. 
SSL 방식을 이용해서 통신을 하는 브라우저와 서버는 HandShake를 한다. 

1. 클라이언트가 서버에 접속한다. 이 단계를 ClientHello라고 한다. 그리고 아래와 같은 데이터를 주고 받는다.
  - 클라이언트 측에서 생성한 랜덤 데이터
  - 클라이언트가 지원하는 암호화 방식들  
  - 세션 아이디 
2. 서버는 Client Hello에 대한 응답으로 Server Hello를 하게 된다. 
  - 서버 측에서 생성한 랜덤 데이터
  - 서버가 선택한 클라이언트의 암호화 방식
  - 인증서 
3. 클라이언트는 서버의 인증서가 CA(Certificate Authority)에 의해서 발급된 것인지를 확인하기 위해서 클라이언트에 내장된 CA 리스트를 확인한다. 인증서가 CA에 의해서 발급된 것인지 확인하기 위해서 클라이언트에 내장된 CA의 공개키를 이용해서 인증서를 복호화한다. 복호화에 성공했다면 인증서는 CA의 개인키로 암호화된 문서임이 암시적으로 보증된다. 인증서를 전송한 서버를 믿을 수 있게 된 것이다. 

### 전송 



# 세션

실제로 서버와 클라이언트가 데이터를 주고 받는 단계를 말한다. 정보를 상대방에게 전송하기 전에 session key 값을 이용해서 대칭키 방식으로 암호화한다. 암호화된 정보는 상대방에게 전송될 것이고, 상대방도 세션키 값을 알고 있기 때문에 암호를 복호화할 수 있다. 

# 세션종료

데이터의 전송이 끝나면 SSL 통신이 끝났음을 서로에게 알려준다. 

### 세션 종료 


# 참고한 사이트

[https://universitytomorrow.com/22](https://universitytomorrow.com/22)
[https://www.youtube.com/watch?v=8R0FUF_t_zk](https://www.youtube.com/watch?v=8R0FUF_t_zk)