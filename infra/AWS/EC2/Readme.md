# 서론

오늘은 AWS와 S3, CloudFront에 대해서 알아보고 프론트엔드 서버에서 활용할 이미지를 Cloudfront에 배포해보겠습니다. 이 글은 `생활코딩 - AWS1` 수업을 듣고 요약한 내용을 담고 있음을 밝힙니다.

# 본론

### EC2 살펴보기

EC2 인스턴스를 고르는 일은 월세 집 구하는 것과 비슷합니다. 조건에 따라, 가격이 천차만별이기 때문입니다.
CPU의 갯수, 메모리 크기, 네트워크 성능 등으로 구분됩니다. 또 일정 부분까지는 무료로 사용할 수 있습니다. 예를 들어, EC2의 경우에는 t2.micro 인스턴스를 1년 간 750시간을 무료로 사용하는 혜택을 제공합니다.

### EC2 사용해보기

이번 시간에는 EC2 인스턴스를 실제로 실행 및 삭제 하는 방법에 대해서 알아보겠습니다. 그리고 사용량에 따른 비용 계산도 함께 살펴보도록 하겠습니다.

먼저 회원가입부터 해보겠습니다.

### EC2 보안 설정하기

OTP를 설정하면 계정을 더욱 안전하게 보관할 수 있습니다.

멀티 팩터 인증(MFA)가 있습니다.

대표적인 것이 S3입니다. S3를 활용하면 파일을 클라우드 환경에서 활용할 수 있습니다.

### EC2 보안그룹 설정하기

EC2에선 보안그룹 규칙을 통해 EC2 인스턴스로 들어오고 나가는 트래픽을 세부적으로 제어할 수 있도록 해주고 있습니다.
예를 들어, SSH접속 포트인 22번 포트는 개발자 PC에서만 접근 가능하도록 허용할 수 있고 서비스 포트인 80포트는 모두에게 허용할 수 있도록 설정 가능합니다.

### EC2 인스턴스에 접속하기

SSH를 사용하여 EC2 인스턴스에 접속할 수 있습니다. 윈도우라면 SSH를 사용하기 위해 별도의 프로그램을 설치해야하고, 리눅스 또는 OS X라면 대부분 SSH가 기본으로 설치되어 있습니다.

- 리눅스 & OS X : 먼저 SSH로 접속할 주소를 알아야 합니다. EC2 인스턴스의 Public DNS를 복사합니다.

터미널을 열고 SSH를 실행합니다. EC2 인스턴스를 생성할 때 다운로드했던 키 파일(.pem)의 경로를 명시해줘야 합니다.

```shell
chmod 400 [키명].pem
ssh -i "키명.pem" ubuntu@ec2-15-164-234-118.ap-northeast-2.compute.amazonaws.com
```

이제 정상적으로 EC2 인스턴스에 접속되는 것을 볼 수 있습니다. 인스턴스에 접속하면 내 컴퓨터에 설치된 리눅스를 사용하는 것처럼 사용할 수 있습니다.

### EC2 인스턴스 패밀리

| 인스턴스 패밀리                                      | 사용 사례                                                                              |
| ---------------------------------------------------- | -------------------------------------------------------------------------------------- |
| 범용(예: A1, T3, T3a, T2, M6g, M5)                   | 트래픽이 적은 웹 사이트와 웹 어플리케이션 <br/> 소형 데이터베이스 및 중형 데이터베이스 |
| 컴퓨팅 최적화(예: C5, C5n, C4, C7g)                  | 고성능 웹서버 <br/> 동영상 인코딩                                                      |
| 메모리 최적화(예: R5, R5n, X1e, X1, z1d)             | 고성능 데이터베이스 <br/> 분산 메모리 캐시                                             |
| 스토리지 최적화(예: I3, I3en, D2, H1)                | 데이터 웨어하우징 <br /> 로그 또는 데이터 처리 애플리케이션                            |
| 액셀러레이티드 컴퓨팅 (예: P3, P2, Inf1, G4, G3, F1) | 3D 시각화 <br /> 기계 학습                                                             |

### EC2 인스턴스 유형

요금 처리 방식에 따라 4가지로 나뉨. 

- 온디맨드 인스턴스 
- 예약 인스턴스  
  - 장기 계약 시 할인 
  - 1년, 3년 기간 
  - 예약 인스턴스를 특정 가용 영역에 지정 가능함. 
- Saving Plans 
  - 1년, 3년 기간
  - 리전, 인스턴스 패밀리, 사이즈를 변경할 수 있다. 
  - 예약 인스턴스보다는 덜 저렴
  - 해외 진출 계획이 있을 경우 유용함. 
- 스팟 인스턴스 
  - 미사용 서버를 임시로 사용하여 최대 90% 저렴
  - 단지, 언제든지 종료될 수 있는 서버라 재처리 가능한 프로그램에 사용하여야 함. 
  - 경매 방식으로 구매 가능함. 
  - 테스트용, 온디맨드가 어느정도 있는 상태에서 추가로 서버가 필요한 경우 사용 

### 컨테이너 관리형 서비스 

- ECS
  - 간편 관리형 서비스 
  - AWS 전용
  - 컨테이너가 소수일 때 커맨드로 관리 가능하지만, 많아지면 관리가 힘들어 관리형 사용이 필요하다. 
  - ECS는 AWS에서 인프라를 관리해주며, 확장 등이 쉽게 가능하다. 
- EKS
  - 오픈소스인 쿠버네티스 사용의 관리 리소스가 들어감. 
  - AWS 쿠버네티스 관리 오케스트레이션 서비스인 EKS를 사용하면 관리 시간이 줄어든다. 
  - 마스터의 관리를 AWS가 해준다. 
  - 사용자는 워커노드만 관리하면 된다. 
  - 마스터 서버로는 API 서버로 명령만 내릴 수 있다. 로그 모니터링은 가능하다. 
  - 별도의 AWS VPC에 마스터 서버가 구성된다. 사용자는 접근 불가하다. 

### 서버리스 컴퓨팅, 람다

- 이벤트 방식의 서버 처리
- 서버리스도 관리형 서비스이다. 
- 사용자가 확장 등을 고려할 필요가 없다. 
- 모든 것이 자동으로 처리된다. 
- 1시간에 1번 들어오는 서비스의 경우 사용하면 좋다. 
  - EC2는 24시간 운영 필요.
  - 람다는 이벤트 발생 시 트래픽 처리됨. 처리 시만 비용이 발생함. 
  - 1달 사용 시 서버리스 비용이 더 줄어든다. 
  - 람다 사용 시, 개발자는 개발하는데만 집중할 수 있다. 관리형 서비스이다. 
  - 사용한만큼만 지불한다. 
  - 제약 15분 

### 참고한 사이트

[[배워가는블로거:티스토리](https://zamezzz.tistory.com/301)](<[배워가는블로거:티스토리](https://zamezzz.tistory.com/301)>)
[https://brunch.co.kr/@topasvga/2500](https://brunch.co.kr/@topasvga/2500)